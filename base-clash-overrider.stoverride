name: 'BASE-OVERRIDE'
desc: |-
  clash基础配置
author: |-
  dmme
category: 'BASE'
date: '2025-10-12 07:13:21'

rule-providers: #!replace
  AD-REJECT:
    type: http
    behavior: domain
    url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising_Domain.txt'
    interval: 86400
    path: ./ruleset/Advertising_Domain.txt
  
  SteamCN:
    type: http
    behavior: classical
    url: 'https://api-gz.hosbbq.com/nus74f89st1/SC.yml'
    interval: 86400
    path: ./ruleset/SteamCN.yml
  
  Bahamut:
    type: http
    behavior: classical
    url: 'https://api-gz.hosbbq.com/nus74f89st1/Ba.yml'
    interval: 86400
    path: ./ruleset/Bahamut.yml
  
  DMM:
    type: http
    behavior: classical
    url: 'https://api-gz.hosbbq.com/nus74f89st1/DM.yml'
    interval: 86400
    path: ./ruleset/DMM.yml
  
  ChinaMax:
    type: http
    behavior: classical
    url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaMax/ChinaMax.yaml'
    interval: 86400
    path: ./ruleset/ChinaMax.yaml
  
  ChinaMaxIp:
    type: http
    behavior: domain
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax_IP_No_IPv6.txt'
    interval: 86400
    path: ./ruleset/ChinaMax_IP_No_IPv6.txt
rules: #!replace
    - 'PROCESS-NAME,aria2c,DIRECT'
    - 'RULE-SET,AD-REJECT,REJECT'
    - 'DOMAIN-SUFFIX,local,DIRECT'
    - 'IP-CIDR,127.0.0.0/8,DIRECT'
    - 'IP-CIDR,172.16.0.0/12,DIRECT'
    - 'IP-CIDR,192.168.0.0/16,DIRECT'
    - 'IP-CIDR,10.0.0.0/8,DIRECT'
    - 'IP-CIDR,17.0.0.0/8,DIRECT'
    - 'IP-CIDR,100.64.0.0/10,DIRECT'
    - 'IP-CIDR,224.0.0.0/4,DIRECT'
    - 'IP-CIDR,203.0.113.0/24,DIRECT'
    - 'IP-CIDR,192.0.2.0/24,DIRECT'
    - 'IP-CIDR6,fe80::/10,DIRECT'
    - 'RULE-SET,SteamCN,DIRECT'
    - 'RULE-SET,ChinaMaxIp,DIRECT'
    - 'RULE-SET,ChinaMax,DIRECT'
    - 'RULE-SET,Bahamut,🇨🇳TW-AUTO'
    - 'RULE-SET,DMM,🇯🇵JP-AUTO'
    - 'GEOIP,CN,DIRECT'
    - 'GEOIP,LAN,DIRECT'
    - 'MATCH,PROXY'


proxy-groups: #!replace
  # 顶层代理组 - 手动选择策略模式
  - name: PROXY
    type: select
    proxies:
      - ⚡ Auto-Fallback
      - 🔀 Load-Balance
      - 🇭🇰HK-AUTO
      - 🇨🇳TW-AUTO
      - 🇸🇬SG-AUTO
      - 🇯🇵JP-AUTO
      - 🇺🇸US-AUTO
      - 🇰🇷KR-AUTO
      - 🇨🇦CA-AUTO
      - 🇬🇧GB-AUTO
      - OTHER-AUTO

  # 自动故障转移 - 按延迟自动切换到可用节点
  - name: ⚡ Auto-Fallback
    type: fallback
    url: 'http://cp.cloudflare.com/generate_204'
    proxies:
      - 🇭🇰HK-AUTO
      - 🇨🇳TW-AUTO
      - 🇸🇬SG-AUTO
      - 🇯🇵JP-AUTO
      - 🇺🇸US-AUTO
      - 🇰🇷KR-AUTO
      - 🇨🇦CA-AUTO
      - 🇬🇧GB-AUTO
      - OTHER-AUTO

  # 负载均衡 - 分散流量到多个节点
  - name: 🔀 Load-Balance
    type: load-balance
    url: 'http://cp.cloudflare.com/generate_204'
    interval: 600
    strategy: consistent-hashing
    proxies:
      - 🇭🇰HK-AUTO
      - 🇨🇳TW-AUTO
      - 🇸🇬SG-AUTO
      - 🇯🇵JP-AUTO
      - 🇺🇸US-AUTO
      - 🇰🇷KR-AUTO
      - 🇨🇦CA-AUTO
      - 🇬🇧GB-AUTO
      - OTHER-AUTO

  # 香港节点组 - 自动测速选择最快节点
  - name: 🇭🇰HK-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(hong\s?kong|香港|hk|🇭🇰)'

  # 台湾节点组
  - name: 🇨🇳TW-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(taiwan|台湾|tw|Taiwan)'

  # 新加坡节点组
  - name: 🇸🇬SG-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(singapore|新加坡|狮城|sg|🇸🇬)'

  # 日本节点组
  - name: 🇯🇵JP-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(japan|日本|jp|🇯🇵)'

  # 美国节点组
  - name: 🇺🇸US-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 300
    tolerance: 50
    filter: '(?i)(united\s?states|美国|us|🇺🇸)'

  # 韩国节点组
  - name: 🇰🇷KR-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(korea|韩国|kr|🇰🇷)'

  # 加拿大节点组
  - name: 🇨🇦CA-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(canada|加拿大|ca|🇨🇦)'

  # 英国节点组
  - name: 🇬🇧GB-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)(britain|英国|uk|gb|🇬🇧)'

  # 其他地区节点组 - 匹配所有未被上述规则匹配的节点
  - name: OTHER-AUTO
    type: url-test
    url: 'http://www.google.com/generate_204'
    interval: 600
    tolerance: 80
    include-all: true
    filter: '(?i)^(?!.*(hong\s?kong|香港|hk|taiwan|台湾|tw|singapore|新加坡|sg|japan|日本|jp|united\s?states|美国|us|korea|韩国|kr|canada|加拿大|ca|britain|英国|uk|gb)).*'
